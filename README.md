目录

- [1. 课程笔记](#1-课程笔记)
  - [1.1. Lec1](#11-lec1)
  - [1.2. Lec2](#12-lec2)
  - [1.3. Lec4](#13-lec4)
    - [1.3.1. 基因 Microarray(基因组和转录组现在用的不太多;甲基化之类的目前还有在用的)](#131-基因-microarray基因组和转录组现在用的不太多甲基化之类的目前还有在用的)
    - [1.3.2. 基因测序技术(平行测序)](#132-基因测序技术平行测序)
    - [1.3.3. 蛋白组学技术](#133-蛋白组学技术)
    - [1.3.4. 代谢组](#134-代谢组)
    - [1.3.5. 分析流程](#135-分析流程)
  - [1.4. Lec5](#14-lec5)
    - [1.4.1. 基因组(一般序列和注释都是从一个数据库来)](#141-基因组一般序列和注释都是从一个数据库来)
    - [1.4.2. 转录组](#142-转录组)
    - [1.4.3. 差异表达分析，R 包 DESeq2](#143-差异表达分析r-包-deseq2)
    - [1.4.4. 富集分析](#144-富集分析)
  - [1.5. Lec6](#15-lec6)
    - [1.5.1. 实验要求](#151-实验要求)
    - [1.5.2. 背景](#152-背景)
    - [1.5.3. 实验](#153-实验)
    - [1.5.4. 做克隆及转化](#154-做克隆及转化)
    - [1.5.5. 提质粒](#155-提质粒)
    - [1.5.6. 细胞培养](#156-细胞培养)
    - [1.5.7. 粗提 DNA](#157-粗提-dna)
    - [1.5.8. RNA 提取](#158-rna-提取)
    - [1.5.9. qPCR](#159-qpcr)
    - [1.5.10. 其他](#1510-其他)
- [2. 学习计划](#2-学习计划)

# 1. 课程笔记

## 1.1. Lec1

**model**和**algorithm**的区别

- **model**是将具体问题转化为数学语言，后续可以使用解析/数值方法解决
- **algorithm**是解决问题的具体计算机语言实现，同一个问题可以由不同的算法进行实现

## 1.2. Lec2

- bash 对空格要求很严格
- 管道符`|`可以将连接的命令实现将前一个命令的结果作为后一个命令的输入
- 元组定义方法：`("a" "b" "c")`，小括号封装，空格分开各个元素
- 判断方式`[ condition ]`，前后都要有空格，`[[ condition ]]`提示在判断过程中使用正则表达式
- `$((variable cal))`，对 variable 进行计算时要封装在双括号中
- `${variable}`对 variable 做一些操作并返回，用{}封装
- `$(command)`输出 command 的运行结果
- `sed 's/str1/str2/g'` g 表示所有的都替换，str 支持正则表达式匹配
- `""`和`''`的区别在于对于符号的转义方式不同，例如`"$q"`正常识别变量，`'$q'`无法正确识别变量会输出$q

## 1.3. Lec4

### 1.3.1. 基因 Microarray(基因组和转录组现在用的不太多;甲基化之类的目前还有在用的)

- 好处：
  - 分析比较流程化，可以直接一个函数分析到底
  - 实验比较简单
- 坏处：
  - 无法发现新的 gene，芯片上的 gene 是固定的
  - 基于荧光方法，荧光浓度的线性范围比较窄，对很高浓度和低浓度都测不太准

### 1.3.2. 基因测序技术(平行测序)

- 一代测序做质粒测序等简单的测序也可以，单样本下速度也很快并且准确度也很高
- 二代测序要测多少个 cycle 代表了测序能测多长
- 原版的方法需要 pcr 扩增，会导致额外的 bias，限制是太短了，在基因组上的 map 工作是比较困难的
- **Nanopore**省去了 pcr 扩增，使用了**电压记录**（不同的碱基经过纳米孔的时候产生的电压是不同的），此外理论上可以直接测序 RNA，而不需要将 RNA 反转录成 cDNA 再进行测序，该想法也可以扩展到**蛋白质**。
  - 可以更快更长
  - 电信号处理不需要像光学一样条件非常苛刻，可以把测序机器做的很小巧方便。
  - 直接测序可以进一步探测到比如**碱基修饰**等信息，不会被反转录过程抹去
  - 可以进一步探测分子结构，比如环状的 DNA，有茎环结构的 RNA 等
- single molecule 办法不需要 pcr 扩增，也可以更快更长

### 1.3.3. 蛋白组学技术

- microarray，使用抗体，效果不是特别好
- 质谱，也是打成小段，在 library 在进行比对，目前精度还做不到单细胞，并且也没有办法区分序列上比较相近的蛋白。此外对低丰度的蛋白很难进行检测。
- 二维电泳。一般结合质谱一起使用，先在实验组和对照组做 2D gel，比较差别，再挖出来送去做质谱

### 1.3.4. 代谢组

- NMR 进行检测

### 1.3.5. 分析流程

- 预处理
  - transformation，adjust dynamic range，基因表达谱跨度特别大，表达基数不同的时候对 variance 的敏感程度不一样
  - normalization，需要考虑处理背后的假设
- 差异表达分析(变化是不是显著)
  - p value 一般取-lg, 一般关注 p vale 大且表达的 deviation 比较大的 gene
  - 聚类分析最简单的是根据表达量的高低做聚类，也可以根据表达的 pattern 等信息来做聚类
- function annotation 富集分析(GSEA)
  - 将 gene list 作为一个整体进行研究
  - 把所有的 gene 在整个测序中差异表达做排序，得到 rank，从小到大遍历，遇到 gene list 中的 gene 就加分，遇到非 gene list 的 gene 就减分，因为 gene list 中的 gene 是比较少的，所以加分的权重比较大，另外主要关心的是两端的 gene，两端的 gene 的得分权重更大，可以得到一个总分数的曲线(也可以看到 peak 的位置，看 peak 是否更加倾向于某一个 phenotype)以及总分数，这样无论定义的是什么 gene list 都有一个打分方式，可以用打分做后续的分析，也可以知道是否有富集之类的问题
    - 容忍一定程度的噪音，两端的 gene 的变化很大，更不可能是假阳性/阴性，也因此权重比较大，而中间的 gene 可能有一些变化但是变化不大可能是假的或者是噪音导致的变化，因此权重也更小
    - gene list 的定义可能有点错的，但是错的这些大概率的差异表达 rank 是 random 的，或者比较小的权重比较低，对整体的影响不大
  - 选一个 gene set 做，gene set 比如 GO 数据
- 控制 FDR 的方法
  - BH 方法（矫正 p value）
  - permutation 方法，得到对于随机误差的估计，利用随机 shuffle，得到假的 control 和实验组，从而得到如果是随机情况下的随机误差的分布。再拿真实数值来看，用随机误差的分布算出是随机误差的概率，如果概率很小就可以接受。shuffle 目的就是模拟真实的随机误差

## 1.4. Lec5

### 1.4.1. 基因组(一般序列和注释都是从一个数据库来)

- 组装(得到序列)
  - N50 越高，基因组组装效果越好
  - reads 越长组装效果越好
  - 先根据 overlap，map 出 contig，再搭出 scaffold
- 注释
  - 软件如 SNAP，从头注释，不需要先验知识但是结果不一定是对的
  - 或者比对到基因组上去
  - 不同数据库的注释方法是不一样的，因此不同的数据库结果是不同的
  - 数据库是 NCBI(ref-seq 注释办法，只包括有实验证据的)，Ensembl(包括一部分的从头注释的结果以及有实验数据的)，Genome Browser(也是有实验和从头注释的部分，但是也重新搞过了)
  - **GRCh38 是最常用的人类基因组的 ref seq**
- FASTA 格式，最常用的`序列`存储格式
  - 开头为`>`后面是蛋白信息，一行，下一行是序列的具体信息（两行为一个单元）
  - soft mask/hard mask,把重复序列屏蔽掉，soft 重复的小写不重复的大写，hard 把重复的变成 N
  - `Biostrings`，R 语言处理 fasta，可以实现提取子序列，翻译，生成 complement 序列等方式
- GFF/GTF 格式，常用的`基因注释`格式
  - 谈基因组位置的时候要注意是 0 计数还是 1 计数，这两个格式都是 1 开始计数的
  - attribute 是主要的注释的信息，不同的数据库上面下载的很有可能是不一样的
  - `GenomicFeatures`，R 语言处理 GTF 文件，读取时需要输入 taxonomyId，物种序列号，自带一些函数如 promoter CDS exon 等直接提取一些信息
  - 一个基因会对应多种转录本（TXNAME）
  - IGV 软件，进行基因组可视化

### 1.4.2. 转录组

- 测序的办法
  - Ribo-minus，去掉 rRNA 不加入后续分析
  - poly A 尾的拿出来检测
  - 单端和双端测序，双端测序对发现新的转录本的结构更有优势
  - 链特异性和非链特异性，前者合成另一条链的时候用 U，然后把带 U 的降解，只用一个方向的进行测序，后者用 T，因此测出来两个方向都有可能，分析表达量的差异时没有大区别，研究可变剪接要用链特异性的
  - 生物学重复指多一些实验动物/细胞，分别测，多样本
  - batch effect，样本很多时需要分批建库和测序，需要去除 batch effect，实验设计时采取 RCBD
  - 测序深度是测序的碱基数量/基因组大小
  - map 到基因组上，计算每个 gene 的 count，map 到基因组上时需要考虑是否是链特异性的测序
- sam/bam 文件
  - sam 可读，比较大，bam 比较小是个二进制文件
  - 需要 sort 排序生成 index 后才能进一步进行操作
  - htseq-count 进行 map 后的计数，需要注意是不是链特异性的测序
- raw count 的 normalize
  - RPM/CPM 某个 gene 的 reads/建库的所有 reads
  - RPKM 比 RPM 多除以一个 gene length
  - TPM
  - rlog
- RSeQC
  - 质量控制

### 1.4.3. 差异表达分析，R 包 DESeq2

- result(DESeq(data)) 直接出结果
- `InteractiveComplexHeatmap`交互式 heatmap

### 1.4.4. 富集分析

- gene ontology(GO)，注释基因的功能
- evidence code GO 和 gene 的关系是根据什么建立起来的
- GO Ribbon 显示基因的注释水平的区别
- 注释包 org.Hs.eg.db，根据需求可以选择不同的注释包
- 思路：从 N 个样本中抽 n 个基因，其中 N 中有 m 个某 GO term，n 中有 i 个某 GO term，则富集程度服从超几何分布
- `GOplot`作图
- `gsea`方法不需要卡阈值，根据排序估计是个非参数方法做的统计分析，必须要先 DESeq2 处理一下 normalize 之后再做，可以用 R 语言或者提供的软件来做

- TF 发现
  - 数据：TNBC 的三阴性乳腺癌，有更强的侵袭和转移的能力，异质性比较强，通过 accession code 下载数据，一般从 raw counts 进行分析，如果做很下游的可以用 norm
  - 单细胞聚类，三个肿瘤类型的区别，关注某些和侵袭转移的 gene，找到某个 cluster 的比较牛，再得到这个 cluster 的 marker gene，后续可以用这个 marker gene 作为
  - 通过可变剪切(AS)视角进行 cluster,可以发现哪些正常细胞更接近肿瘤细胞，通过 pseudotime 分析可以看到那些基因的分化程度高低
  - `ARANCE`分析调控网络，输入为 gene list(TF)和 seurat 类型的 experiment 的数据，MI 互信息的值，调控网络可以用来计算上游基因的活性
  - `Marina`(R package)在不同的 cluster 中根据 TF 的调控活性而非简单的 TF 表达量作为“差异基因”的比较标准，因此需要先用`ARANCE`得到调控网络作为输入

## 1.5. Lec6

### 1.5.1. 实验要求

实验报告：实验名称，实验目的，实验设计（实验步骤），实验结果(如：on target off target score 要截频记录，还有潜在 offtarget 的位置要截频记录)

地点：郑裕彤医学楼 E107

### 1.5.2. 背景

1. Chrisper 引物设计(软件：Benchling)

- spacer（互补配对）和 tracer（二级结构）放在一起是 guide RNA，如果只有一条 guide RNA 就是 sgRNA（single guide RNA）
- **考虑因素**：untarget score 使得更好地敲除基因，考虑到如果剪切掉 3 为单位的核酸就没有办法导致移码突变；考虑不能 offtarget 脱靶
- **原则**：
  - 不能在 UTR 上做，效率不高，因此是从 CDS 设计，从 N 端开始几百个 bp 内都是可以的（尽量在前 3 个 exon）
  - 一般按照 on target score 排序，选前几个，最高的 on target 基础上找 off target 分数尽量高的，同时可以看到哪些 gene 是 off target 的目标，到时候可能也要检测一下对应的 gene 有没有被一起敲掉
  - sgRNA 一般不选有很多重复序列的，比如 AGAGAGAG

2. 其他注意点注意合成的引物是没有磷酸的，需要自己加上磷酸

annealing 的过程需要一个比较合适离子浓度(主要是钠离子浓度)

卡那霉素表达比较慢杀伤性比较强，所以更需要复苏

### 1.5.3. 实验

### 1.5.4. 做克隆及转化

- 载体要测一下浓度，载体和片段分离是用一个膜分离而不是用胶回收的方式
- PNK 是加磷酸的酶，37 度加磷酸

### 1.5.5. 提质粒

- solution1 中有 RNAase
- NaOH 在 solution2 中，使得核 DNA 解旋
- solution3 中有很多 detergent 破膜等
- wash 中加了胍盐，变性非特异性的 ecoli 中的内切酶
- 1w 左右的质粒是否用高温的洗脱液的洗脱效率差不多，但是 10w 左右的质粒高温洗脱会更好地提高效率

### 1.5.6. 细胞培养

- 培养基带显色剂，Ph 越低会越黄
- 细胞自己的生长因子让比较密的细胞比较好长
- 生长期转质粒，要让质粒转进去的时候细胞至少细胞核解体一次让质粒进到细胞核里，这样才能表达

### 1.5.7. 粗提 DNA

- 适用场合：只要破了核膜，能够拿到 DNA，后续 DNA 能把要的东西 p 出来就可以了。
- 重要试剂：一些蛋白酶破核膜，消化组蛋白等，detergent
- 不适合扩增大的片段，只能扩增小的几百 bp 的片段，因为是比较强烈的消化方法
- 得到的 DNA 是一个混合物，包括没有转染成功的，成功转染敲除失败的和成功编辑的，因此在观察结果的时候如果在观察位置有峰嵌套时说明发生了编辑，有移码；需要经过信号处理后将不同的峰分开，假设删除后就是一个 WT 的峰的位置移动
- 估计的结果的比例/转染效率大致就能估计出多少细胞被编辑了，得到编辑效率

### 1.5.8. RNA 提取

使用随机引物时，只适合做 qP 鉴定数量，不适合做 RNA 全长鉴定

### 1.5.9. qPCR

qPCR 引物一般只要能够 p 出 150 bp 左右的长度

### 1.5.10. 其他

- 实验设计时，control 最好是一个 truncate 的 sg，其次是切别的地方的 sg，再次是 random 的 sgRNA（可能不会导致任何切割）
- BbsI 粘性末端连接法(识别序列和酶切序列不在一起，所以可以构造任何粘性末端)，sgRNA 多设计一下粘性末端，直接合成即可
- 验证是否敲除需要对敲除位点附近 700 做一个测序，需要再设计一个引物

---

# 2. 学习计划

- [ ] 学习组学分析的模型原理和实现
- [ ] 增强 linux，python 与 R 的使用
- [ ] 学习组学分析的基本研究范式
